<!-- Generated by documentation.js. Update this documentation by updating the source code. -->

### Table of Contents

-   [esBuilder](#esbuilder)
-   [option](#option)
-   [body](#body)
-   [build](#build)
-   [indices](#indices)
-   [type](#type)
-   [query](#query)
-   [aggs](#aggs)
-   [fields](#fields)
-   [size](#size)
-   [rawOption](#rawoption)
-   [from](#from)
-   [appendAggs](#appendaggs)
-   [subAggs](#subaggs)
-   [forkAggs](#forkaggs)
-   [mergeAggs](#mergeaggs)
-   [bool](#bool)
-   [boolMust](#boolmust)
-   [boolNot](#boolnot)
-   [boolShould](#boolshould)
-   [boolFilter](#boolfilter)

## esBuilder

elastic-search-builder working with [elasticsearch.js](https://www.elastic.co/guide/en/elasticsearch/client/javascript-api/current/index.html)

See more use case in the docs as well as in the tests.

**Examples**

```javascript
Usage

const elasticsearch = require('elasticsearch');
const client = new elasticsearch.Client({
     host: 'localhost:9200'
});
const esb = require('elastic-search-builder');
const searchparams = esb()
 .option()
 .indices(['2016.01.01'])
 .body()
 .query({
     match: {
         message: 'hello world'
     }
  })
 .aggs()
 .build();
client.search(searchparams).then(body => {
     console.log(body)
})
```

Returns **([option](#option) \| [body](#body) \| [build](#build))** see below.

## option

Add custom option

**Parameters**

-   `content` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** option body.

**Examples**

```javascript
//build option
esb().option({
  index: 'logs',
  type: '2016.01.01'
}).build()
```

Returns **([indices](#indices) \| [type](#type))** see below

## body

Add custom body

**Parameters**

-   `content` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** option body.

**Examples**

```javascript
esb().body({
   query: {
      match: {
         message: 'hello'
      }
   }   
})
.build()
```

Returns **([query](#query) \| [aggs](#aggs) \| [fields](#fields) \| [size](#size) \| [from](#from))** see below.

## build

Build with options and body.

Returns **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** search option.

## indices

Add index field to option.

**Parameters**

-   `indices` **([Array](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Array) \| [string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String))** multi index (optional, default `[]`)
-   `ignoreUnavailable` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Whether specified concrete indices should be ignored when unavailable (missing or closed)
-   `allowNoIndices` **[boolean](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Boolean)** Whether to ignore if a wildcard indices expression resolves into no concrete indices. (This includes \_all string or when no indices have been specified)

**Examples**

```javascript
esb()
 .options()
 .indices(['2016.01.01'], true, true)
 .build()
```

```javascript
esb()
 .options()
 .indices('2016.01.01,2016.02.02', false, false)
 .build()
```

## type

Add type field to option

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .options()
 .type(['company', 'school'], 'employee', 'student')
 .build()
```

## query

Add query clause to query body

**Parameters**

-   `queryBody` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** any query clause (optional, default `{}`)

**Examples**

```javascript
//build body
esb()
 .body()
 .query({
     match: {
         message: 'hello'
     }
 })
 .build()
//result:
{
    body: {
         query: {
             match: {
                 message: 'hello'
             }
        }   
    }
}
```

Returns **[bool](#bool)** see below.

## aggs

Add aggregation to aggs body

**Parameters**

-   `aggsBody` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** any aggregation body (optional, default `{}`)

**Examples**

```javascript
esb()
 .body()
 .aggs({
     message: {
         terms: {
             field: 'message'
         }
     }
 })
 .build();
//result:
{
     body: {
         aggs: {
             message: {
                 terms: {
                     field: 'message'
                 }
             }
         }
     }
}
```

Returns **([appendAggs](#appendaggs) \| [subAggs](#subaggs) \| [forkAggs](#forkaggs) \| [mergeAggs](#mergeaggs))** see below.

## fields

**_<https://www.elastic.co/guide/en/elasticsearch/reference/current/search-field-caps.html>_**

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .body()
 .fields('rating', 'count')
 .build()
//result:
{
     body: {
         fields: ['rating', 'count']
     }
}
```

## size

**_<https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-from-size.html>_**

**Parameters**

-   `size` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `0`)

**Examples**

```javascript
esb()
 .size(10)
 .build()
//result:
{
     body: {
         size: 10
     }
}
```

## rawOption

**Parameters**

-   `key` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** 
-   `value` **Any** 

**Examples**

```javascript
esb()
 .body()
 .rawOption('_source', ['obj1.*', 'obj2.*'])
 .build();
// result:
{
     body: {
         _source: ['obj1.*', 'obj2.*']
     }
}
```

## from

**_<https://www.elastic.co/guide/en/elasticsearch/reference/current/search-request-from-size.html>_**

**Parameters**

-   `from` **[number](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Number)**  (optional, default `0`)

**Examples**

```javascript
esb()
 .from(1)
 .build()
//result:
{
     body: {
         from: 1
     }
}
```

## appendAggs

Add an aggregation clause to the aggs body.

**Parameters**

-   `name` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the aggregation.
-   `type` **[string](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/String)** Name of the aggregation type, such as `'sum'` or `'terms'`.
-   `body` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** Options to include in the aggregation.

**Examples**

```javascript
esb()
 .body()
 .aggs()
 .appendAggs('message', 'terms', {
     field: 'message'
 })
 .build();
```

## subAggs

Add aggregation to sub aggs body.

**Parameters**

-   `aggsBody` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)**  (optional, default `{}`)

**Examples**

```javascript
esb()
 .body()
 .aggs()
 .appendAggs('message', 'terms', {
     field: 'message'
 })
 .subAggs()
 .appendAggs('name', 'terms', {  
     field: 'name'
 })
 .build();
//result
{
 "body": {
     "aggs": {
         "message": {
             "terms": {
                 "field": "message"
             },
             "aggs": {
                 "name": {
                     "terms": {
                         "field": "name"
                     }
                 }
             }
         }
     }
 }
}
```

## forkAggs

fork from current aggs node

**Examples**

```javascript
esb()
 .body()
 .aggs()
 .appendAggs('by_gender', 'terms', {
      "field": "gender"
  })
 .subAggs()
 .forkAggs()
 .appendAggs('by_city', 'terms', {
     "field": "city"
 })
 .subAggs()
 .appendAggs('all_name', 'terms', {
     "field": "name"
 })
 .mergeAggs()
 .appendAggs('by_language', 'terms', {
     "field": "language"
 })
 .subAggs()
 .appendAggs('all_name', 'terms', {
     "field": "name"
 })
 .build()
//result:
{
  "aggs": {
      "by_gender": {
          "terms": {
              "field": "gender"
          },
          "aggs": {
              "by_city": {
                  "terms": {
                      "field": "city"
                  },
                  "aggs": {
                      "all_name": {
                          "terms": {
                              "field": "name"
                          }
                      }
                  }
              },
              "by_language": {
                  "terms": {
                      "field": "language"
                  },
                  "aggs": {
                      "all_name": {
                          "terms": {
                              "field": "name"
                          }
                      }
                  }
              }
          }
      }
  }
}
```

## mergeAggs

-   **See: [forkAggs](#forkaggs)**

## bool

Add bool clause to query body.

**Parameters**

-   `boolBody` **[Object](https://developer.mozilla.org/docs/Web/JavaScript/Reference/Global_Objects/Object)** bool clause

**Examples**

```javascript
esb()
 .body()
 .query()
 .bool({
     must: {
         term : { user : 'kimchy' }
     },
     must_not: {
         range: {
             age: {
                 gte: 10,
                 lte: 20
             }
         }
     }
 })
 .build()
//result:
{
     "body": {
         "query": {
             "bool": {
                 "must": {
                     "term": { "user": "kimchy"}
                 },
                 "must_not": {
                     "range": {
                         "age": {
                             "gte": 10,
                             "lte": 20
                         }
                     }
                 }
             }
         }
     }
}
```

Returns **([boolMust](#boolmust) \| [boolNot](#boolnot) \| [boolShould](#boolshould) \| [boolFilter](#boolfilter))** see below.

## boolMust

The clause (query) must appear in matching documents and will contribute to the score.

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .body()
 .query()
 .bool()
 .boolMust({
     term : { user : 'kimchy' }
 })
 .build()

//result
{
 "body": {
     "query": {
         "bool": {
             "must": [
                 {
                     "term" : { 
                         "user" : 'kimchy' 
                     }
                 }
             ]
         }
     }
 }
}
```

## boolNot

The clause (query) must not appear in the matching documents. 
Clauses are executed in filter context meaning that scoring is ignored and clauses are considered for caching. 
Because scoring is ignored, a score of 0 for all documents is returned.

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .body()
 .query()
 .bool()
 .boolNot({
     term : { user : 'kimchy' }
 })
 .build()

//result
{
 "body": {
     "query": {
         "bool": {
             "must_not": [
                 {
                     "term" : { 
                         "user" : 'kimchy' 
                     }
                 }
             ]
         }
     }
 }
}
```

## boolShould

The clause (query) should appear in the matching document. 
If the bool query is in a query context and has a must or filter clause then a document will match the bool query even if none of the should queries match. 
In this case these clauses are only used to influence the score. 
If the bool query is a filter context or has neither must or filter then at least one of the should queries must match a document for it to match the bool query. 
This behavior may be explicitly controlled by settings the minimum_should_match parameter.

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .body()
 .query()
 .bool()
 .boolShould({
     term : { user : 'kimchy' }
 })
 .build()

//result
{
 "body": {
     "query": {
         "bool": {
             "should": [
                 {
                     "term" : { 
                         "user" : 'kimchy' 
                     }
                 }
             ]
         }
     }
 }
}
```

## boolFilter

The clause (query) must appear in matching documents. 
However unlike must the score of the query will be ignored. 
Filter clauses are executed in filter context, meaning that scoring is ignored and clauses are considered for caching.

**Parameters**

-   `args` **...any** 

**Examples**

```javascript
esb()
 .body()
 .query()
 .bool()
 .boolFilter({
     term : { user : 'kimchy' }
 })
 .build()

//result
{
 "body": {
     "query": {
         "bool": {
             "filter": [
                 {
                     "term" : { 
                         "user" : 'kimchy' 
                     }
                 }
             ]
         }
     }
 }
}
```
